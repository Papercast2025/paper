<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1440, initial-scale=1.0">
  <title>Environmental Snapshot</title>
  <style>
    body {
      background-color: #ffffff;
      color: #000000;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      width: 1440px;
      height: 2560px;
      -webkit-text-size-adjust: none;
    }
    .container {
      padding: 32px;
      display: -webkit-flex;
      -webkit-flex-direction: column;
      -webkit-justify-content: flex-start;
      gap: 28px;
    }
    .section {
      border: 2px solid #000;
      padding: 16px;
      -webkit-border-radius: 8px;
      background-color: #ffffff;
    }
    .section h2 {
      margin-top: 0;
      font-size: 40px;
      border-bottom: 2px solid #000;
      padding-bottom: 10px;
    }
    .value {
      font-size: 64px;
      font-weight: bold;
      margin: 10px 0;
    }
    .label {
      font-size: 28px;
      color: #444;
    }
    .timestamp {
      font-size: 28px;
      color: #222;
      margin-top: 40px;
      text-align: center;
    }
    .forecast-day {
      margin-top: 10px;
      font-size: 32px;
    }
  </style>
</head>
<body>
  <div class="container">

    <div class="section">
      <h2>⛅ Weather</h2>
      <div class="value">66°F</div>
      <div class="label">Partly Cloudy</div>
      <div class="label">Wind: 5 mph NW</div>
      <div class="label">Humidity: 62%</div>
    </div>

    <div class="section">
      <h2>🌫️ Air Quality Index (AQI)</h2>
      <div class="label"><strong>Location 1:</strong></div>
      <div class="value" id="aqi-1">--</div>
      <div class="label" id="aqi-desc-1">Loading...</div>

      <div class="label" style="margin-top:20px;"><strong>Location 2:</strong></div>
      <div class="value" id="aqi-2">--</div>
      <div class="label" id="aqi-desc-2">Loading...</div>
    </div>

    <div class="section">
      <h2>🌞 UV Index</h2>
      <div class="value">6</div>
      <div class="label">High (Wear protection)</div>
    </div>

    <div class="section">
      <h2>🔥 Heat Index</h2>
      <div class="value">70°F</div>
      <div class="label">Feels Like</div>
    </div>

    <div class="section">
      <h2>🌊 Flood Risk Level</h2>
      <div class="value">Moderate</div>
      <div class="label">Localized flooding possible in low-lying areas</div>
    </div>

    <div class="section">
      <h2>🏞️ River & Water Levels</h2>
      <div class="value">2.83 ft</div>
      <div class="label">USGS Site #02096960</div>
      <div class="label">Status: Below flood stage</div>
    </div>

    <div class="section">
      <h2>🌧️ Precipitation (24h)</h2>
      <div class="value">0.12 in</div>
      <div class="label">Light Rainfall</div>
    </div>

    <div class="section">
      <h2>📅 Rainfall Outlook (Next 3 Days)</h2>
      <div class="forecast-day">Tuesday: 0.08 in (Scattered Showers)</div>
      <div class="forecast-day">Wednesday: 0.25 in (Rain Likely)</div>
      <div class="forecast-day">Thursday: 0.00 in (Clear)</div>
    </div>

    <div class="section">
      <h2>🚨 Heat Illness Risk</h2>
      <div class="value">Elevated</div>
      <div class="label">Caution advised for outdoor workers and vulnerable groups</div>
      <div class="label">Hydration and shaded rest breaks recommended</div>
      <div class="label">Peak risk period: 12 PM – 5 PM</div>
    </div>

    <div class="timestamp" id="last-updated">
      Last updated: Loading...<br />
      Source: NWS / EPA / CDC / USGS APIs
    </div>
  </div>

  <script>
    const apiKey = '26158E56-5836-46D3-B819-92969016332B';

    const locations = [
      { lat: 35.7765900, lon: -79.1459700, aqiId: 'aqi-1', descId: 'aqi-desc-1' },
      { lat: 35.7309950, lon: -79.1071090, aqiId: 'aqi-2', descId: 'aqi-desc-2' }
    ];

    function getAQIDescription(aqi) {
      if (aqi <= 50) return 'Good';
      if (aqi <= 100) return 'Moderate';
      if (aqi <= 150) return 'Unhealthy for Sensitive Groups';
      if (aqi <= 200) return 'Unhealthy';
      if (aqi <= 300) return 'Very Unhealthy';
      return 'Hazardous';
    }

    function updateTimestamp() {
      const now = new Date();
      const formatted = now.toLocaleString('en-US', {
        month: '2-digit', day: '2-digit', year: 'numeric',
        hour: '2-digit', minute: '2-digit', hour12: true
      });
      document.getElementById('last-updated').innerHTML =
        `Last updated: ${formatted}<br/>Source: NWS / EPA / CDC / USGS APIs`;
    }

    async function fetchAQI(lat, lon, aqiId, descId) {
      try {
        const response = await fetch(`https://www.airnowapi.org/aq/observation/latLong/current/?format=application/json&latitude=${lat}&longitude=${lon}&distance=25&API_KEY=${apiKey}`);
        const data = await response.json();
        const pm25 = data.find(d => d.ParameterName === 'PM2.5');
        if (pm25) {
          document.getElementById(aqiId).textContent = pm25.AQI;
          document.getElementById(descId).textContent = getAQIDescription(pm25.AQI);
        } else {
          document.getElementById(descId).textContent = 'Data unavailable';
        }
      } catch (err) {
        console.error('Error fetching AQI:', err);
        document.getElementById(descId).textContent = 'Error loading data';
      }
    }

    window.onload = () => {
      updateTimestamp();
      locations.forEach(loc => fetchAQI(loc.lat, loc.lon, loc.aqiId, loc.descId));
    };
  </script>
</body>
</html>
