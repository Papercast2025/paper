<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1440, initial-scale=1.0">
  <title>Environmental Snapshot</title>
  <style>
    body {
      background-color: #ffffff;
      color: #000000;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      width: 1440px;
      height: 2560px;
      -webkit-text-size-adjust: none;
    }
    .container {
      padding: 32px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      gap: 28px;
    }
    .group-label {
      font-size: 36px;
      font-weight: bold;
      border-bottom: 2px solid black;
      margin-top: 20px;
      padding-bottom: 6px;
    }
    .section {
      border: 2px solid #000;
      padding: 16px;
      border-radius: 8px;
      background-color: #ffffff;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .section h2 {
      margin-top: 0;
      font-size: 48px;
      background-color: #000;
      color: #fff;
      padding: 10px;
      border-radius: 4px;
      flex: 1;
    }
    .section-content {
      flex: 2;
      padding-left: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      text-align: right;
    }
    .value {
      font-size: 100px;
      font-weight: bold;
      margin: 10px 0;
    }
    .label {
      font-size: 32px;
      color: #444;
    }
    .timestamp {
      font-size: 28px;
      color: #222;
      margin-top: 40px;
      text-align: center;
    }
    .forecast-day {
      margin-top: 10px;
      font-size: 32px;
      text-align: right;
    }
    .alert {
      border: 2px solid #000;
      padding: 8px;
      margin: 5px 0;
      border-radius: 4px;
      font-size: 28px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container" style="overflow: hidden; height: 2560px;">
    <!-- Content remains unchanged -->

    <div class="timestamp" id="last-updated">Loading...</div>
    <div class="timestamp" style="font-size: 24px; text-align: center; margin-top: 20px;">
      For more information, visit <a href="https://www.chathamcountync.gov/" target="_blank">chathamcountync.gov</a>
    </div>
  </div>

  <script>
    // Repaired river graph logic
try {
  const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
  svg.setAttribute("width", "440");
  svg.setAttribute("height", "100");
  svg.setAttribute("viewBox", "0 0 440 100");

  const values = [4.1, 4.3, 4.5, 4.8, 5.1, 4.9, 4.7]; // placeholder or fetched data
  const min = Math.min(...values);
  const max = Math.max(...values);
  const floodStage = 5.0;
  const graphOffsetX = 40;
  const graphWidth = 360;

  const path = values.map((v, i) => {
    const x = graphOffsetX + (i / (values.length - 1)) * graphWidth;
    const y = 100 - ((v - min) / (max - min)) * 100;
    return `${i === 0 ? 'M' : 'L'}${x},${y}`;
  }).join(' ');

  const polyline = document.createElementNS("http://www.w3.org/2000/svg", "path");
  polyline.setAttribute("d", path);
  polyline.setAttribute("stroke", "black");
  polyline.setAttribute("fill", "none");
  polyline.setAttribute("stroke-width", "2");
  svg.appendChild(polyline);

  // Add flood stage line
  if (floodStage >= min && floodStage <= max) {
    const y = 100 - ((floodStage - min) / (max - min)) * 100;
    const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line.setAttribute("x1", graphOffsetX);
    line.setAttribute("x2", graphOffsetX + graphWidth);
    line.setAttribute("y1", y);
    line.setAttribute("y2", y);
    line.setAttribute("stroke", "black");
    line.setAttribute("stroke-dasharray", "6,3");
    svg.appendChild(line);

    const floodLabel = document.createElementNS("http://www.w3.org/2000/svg", "text");
    floodLabel.setAttribute("x", graphOffsetX + 5);
    floodLabel.setAttribute("y", y - 4);
    floodLabel.setAttribute("font-size", "12");
    floodLabel.setAttribute("fill", "black");
    floodLabel.textContent = "Flood Stage";
    svg.appendChild(floodLabel);
  }

  // Add Y-axis labels
  const labelMin = document.createElementNS("http://www.w3.org/2000/svg", "text");
  labelMin.setAttribute("x", "0");
  labelMin.setAttribute("y", "100");
  labelMin.setAttribute("font-size", "14");
  labelMin.textContent = `${min.toFixed(1)} ft`;
  svg.appendChild(labelMin);

  const labelMax = document.createElementNS("http://www.w3.org/2000/svg", "text");
  labelMax.setAttribute("x", "0");
  labelMax.setAttribute("y", "12");
  labelMax.setAttribute("font-size", "14");
  labelMax.textContent = `${max.toFixed(1)} ft`;
  svg.appendChild(labelMax);

  // Add x-axis day labels
  values.forEach((_, i) => {
    const tick = document.createElementNS("http://www.w3.org/2000/svg", "text");
    tick.setAttribute("x", `${graphOffsetX + (i / (values.length - 1)) * graphWidth}`);
    tick.setAttribute("y", "95");
    tick.setAttribute("font-size", "12");
    tick.setAttribute("text-anchor", "middle");

    const now = new Date();
    now.setDate(now.getDate() - (values.length - 1 - i));
    const label = now.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
    tick.textContent = label;
    svg.appendChild(tick);
  });

  document.body.appendChild(svg);
} catch (err) {
  console.error('River graph error:', err);
}
  </script>
</body>
</html>
